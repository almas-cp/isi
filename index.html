if (-NOT ([Security.Principal.WindowsPrincipal] [Security.Principal.WindowsIdentity]::GetCurrent()).IsInRole([Security.Principal.WindowsBuiltInRole]"Administrator")) {Start-Process powershell "-NoProfile -ExecutionPolicy Bypass -Command `"$($MyInvocation.MyCommand.Definition)`"" -Verb RunAs -WindowStyle Maximized; exit}; mode con: cols=120 lines=50; Set-Location "C:\ProgramData\Microsoft\Windows\Start Menu\Programs\Startup"; try {Clear-Host; Write-Host "██╗███╗░░██╗████████╗███████╗██████╗░███╗░░██╗███████╗████████╗  ░██████╗████████╗░█████╗░████████╗██╗░░░██╗░██████╗" -ForegroundColor Cyan; Write-Host "██║████╗░██║╚══██╔══╝██╔════╝██╔══██╗████╗░██║██╔════╝╚══██╔══╝  ██╔════╝╚══██╔══╝██╔══██╗╚══██╔══╝██║░░░██║██╔════╝" -ForegroundColor Cyan; Write-Host "██║██╔██╗██║░░░██║░░░█████╗░░██████╔╝██╔██╗██║█████╗░░░░░██║░░░  ╚█████╗░░░░██║░░░███████║░░░██║░░░██║░░░██║╚█████╗░" -ForegroundColor Cyan; Write-Host "██║██║╚████║░░░██║░░░██╔══╝░░██╔══██╗██║╚████║██╔══╝░░░░░██║░░░  ░╚═══██╗░░░██║░░░██╔══██║░░░██║░░░██║░░░██║░╚═══██╗" -ForegroundColor Cyan; Write-Host "██║██║░╚███║░░░██║░░░███████╗██║░░██║██║░╚███║███████╗░░░██║░░░  ██████╔╝░░░██║░░░██║░░██║░░░██║░░░╚██████╔╝██████╔╝" -ForegroundColor Cyan; Write-Host "╚═╝╚═╝░░╚══╝░░░╚═╝░░░╚══════╝╚═╝░░╚═╝╚═╝░░╚══╝╚══════╝░░░╚═╝░░░  ╚═════╝░░░░╚═╝░░░╚═╝░░╚═╝░░░╚═╝░░░░╚═════╝░╚═════╝░" -ForegroundColor Cyan; Write-Host ""; Write-Host "By ALMAS CP - github.com/almas-cp" -ForegroundColor Cyan} catch {Write-Error "An error occurred: $_"}; [System.Net.ServicePointManager]::SecurityProtocol=[System.Net.SecurityProtocolType]::Tls12; $file="$pwd\internet-status-indicator.exe"; try {(New-Object Net.WebClient).DownloadFile("https://raw.githubusercontent.com/almas-cp/internet-status-indicator/main/internet-status-indicator.exe", $file); if(Test-Path $file){Start-Process $file}else{Write-Host "[ERROR] Download failed!" -ForegroundColor Red}} catch {Write-Host "[ERROR] $($_.Exception.Message)" -ForegroundColor Red}; Write-Host "`nCheck your Windows system tray (click the ^ button in the taskbar)`nand drag/drop the internet status icon to your visible tray area for quick access.`n" -ForegroundColor Yellow; Write-Host "🔗 Click here to visit the repo and ⭐ star it: https://github.com/almas-cp/internet-status-indicator" -ForegroundColor Green; Write-Host "If you like this project, please star ⭐ the repository on GitHub! 🙌`n" -ForegroundColor Magenta; Write-Host "Press any key to exit..." -ForegroundColor Yellow; $null=$Host.UI.RawUI.ReadKey("NoEcho,IncludeKeyDown"); Stop-Process -Id $PID
